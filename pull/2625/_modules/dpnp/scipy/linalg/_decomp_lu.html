

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../../../">
<head>
  <meta charset="utf-8" />
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-554F8VNE28"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-554F8VNE28');
    </script>
    
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>dpnp.scipy.linalg._decomp_lu &mdash; Data Parallel Extension for NumPy 0.20.0dev0+10.g4b616faa390 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=03e43079" />
      <link rel="stylesheet" type="text/css" href="../../../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../../../_static/documentation_options.js?v=9b1aed4f"></script>
      <script src="../../../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../../index.html" class="icon icon-home">
            Data Parallel Extension for NumPy
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../quick_start_guide.html">Quick Start Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../reference/index.html">API Reference</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Development information</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../dpnp_backend_api.html">C++ backend API Reference</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">Data Parallel Extension for NumPy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../../../index.html">Module code</a></li>
      <li class="breadcrumb-item active">dpnp.scipy.linalg._decomp_lu</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for dpnp.scipy.linalg._decomp_lu</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="c1"># *****************************************************************************</span>
<span class="c1"># Copyright (c) 2025, Intel Corporation</span>
<span class="c1"># All rights reserved.</span>
<span class="c1">#</span>
<span class="c1"># Redistribution and use in source and binary forms, with or without</span>
<span class="c1"># modification, are permitted provided that the following conditions are met:</span>
<span class="c1"># - Redistributions of source code must retain the above copyright notice,</span>
<span class="c1">#   this list of conditions and the following disclaimer.</span>
<span class="c1"># - Redistributions in binary form must reproduce the above copyright notice,</span>
<span class="c1">#   this list of conditions and the following disclaimer in the documentation</span>
<span class="c1">#   and/or other materials provided with the distribution.</span>
<span class="c1"># - Neither the name of the copyright holder nor the names of its contributors</span>
<span class="c1">#   may be used to endorse or promote products derived from this software</span>
<span class="c1">#   without specific prior written permission.</span>
<span class="c1">#</span>
<span class="c1"># THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS &quot;AS IS&quot;</span>
<span class="c1"># AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE</span>
<span class="c1"># IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE</span>
<span class="c1"># ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE</span>
<span class="c1"># LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR</span>
<span class="c1"># CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF</span>
<span class="c1"># SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS</span>
<span class="c1"># INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN</span>
<span class="c1"># CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)</span>
<span class="c1"># ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF</span>
<span class="c1"># THE POSSIBILITY OF SUCH DAMAGE.</span>
<span class="c1"># *****************************************************************************</span>


<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Interface of the SciPy-compatible Linear Algebra subset for DPNP.</span>

<span class="sd">Notes</span>
<span class="sd">-----</span>
<span class="sd">This module exposes the public API for ``dpnp.scipy.linalg``.</span>
<span class="sd">It contains:</span>
<span class="sd"> - SciPy-like interface functions</span>
<span class="sd"> - documentation for the functions</span>

<span class="sd">&quot;&quot;&quot;</span>


<span class="kn">import</span><span class="w"> </span><span class="nn">dpnp</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">dpnp.linalg.dpnp_utils_linalg</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">assert_stacked_2d</span><span class="p">,</span>
    <span class="n">assert_stacked_square</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">._utils</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">dpnp_lu_factor</span><span class="p">,</span>
    <span class="n">dpnp_lu_solve</span><span class="p">,</span>
<span class="p">)</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&quot;lu_factor&quot;</span><span class="p">,</span>
    <span class="s2">&quot;lu_solve&quot;</span><span class="p">,</span>
<span class="p">]</span>


<div class="viewcode-block" id="lu_factor">
<a class="viewcode-back" href="../../../../reference/generated/dpnp.scipy.linalg.lu_factor.html#dpnp.scipy.linalg.lu_factor">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">lu_factor</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">overwrite_a</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">check_finite</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the pivoted LU decomposition of `a` matrix.</span>

<span class="sd">    The decomposition is::</span>

<span class="sd">        A = P @ L @ U</span>

<span class="sd">    where `P` is a permutation matrix, `L` is lower triangular with unit</span>
<span class="sd">    diagonal elements, and `U` is upper triangular.</span>

<span class="sd">    For full documentation refer to :obj:`scipy.linalg.lu_factor`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    a : (..., M, N) {dpnp.ndarray, usm_ndarray}</span>
<span class="sd">        Input array to decompose.</span>
<span class="sd">    overwrite_a : {None, bool}, optional</span>
<span class="sd">        Whether to overwrite data in `a` (may increase performance).</span>

<span class="sd">        Default: ``False``.</span>
<span class="sd">    check_finite : {None, bool}, optional</span>
<span class="sd">        Whether to check that the input matrix contains only finite numbers.</span>
<span class="sd">        Disabling may give a performance gain, but may result in problems</span>
<span class="sd">        (crashes, non-termination) if the inputs do contain infinities or NaNs.</span>

<span class="sd">        Default: ``True``.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    lu : (..., M, N) dpnp.ndarray</span>
<span class="sd">        Matrix containing `U` in its upper triangle,</span>
<span class="sd">        and `L` in its lower triangle.</span>
<span class="sd">        The unit diagonal elements of `L` are not stored.</span>
<span class="sd">    piv : (..., K) dpnp.ndarray</span>
<span class="sd">        Pivot indices representing the permutation matrix `P`:</span>
<span class="sd">        row i of matrix was interchanged with row piv[i].</span>
<span class="sd">        Where ``K = min(M, N)``.</span>

<span class="sd">    Warning</span>
<span class="sd">    -------</span>
<span class="sd">    This function synchronizes in order to validate array elements</span>
<span class="sd">    when ``check_finite=True``.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    :obj:`dpnp.scipy.linalg.lu_solve` : Solve an equation system using</span>
<span class="sd">                                        the LU factorization of `a` matrix.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import dpnp as np</span>
<span class="sd">    &gt;&gt;&gt; a = np.array([[4., 3.], [6., 3.]])</span>
<span class="sd">    &gt;&gt;&gt; lu, piv = np.scipy.linalg.lu_factor(a)</span>
<span class="sd">    &gt;&gt;&gt; lu</span>
<span class="sd">    array([[6.        , 3.        ],</span>
<span class="sd">           [0.66666667, 1.        ]])</span>
<span class="sd">    &gt;&gt;&gt; piv</span>
<span class="sd">    array([1, 1])</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">dpnp</span><span class="o">.</span><span class="n">check_supported_arrays_type</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
    <span class="n">assert_stacked_2d</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dpnp_lu_factor</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">overwrite_a</span><span class="o">=</span><span class="n">overwrite_a</span><span class="p">,</span> <span class="n">check_finite</span><span class="o">=</span><span class="n">check_finite</span><span class="p">)</span></div>



<div class="viewcode-block" id="lu_solve">
<a class="viewcode-back" href="../../../../reference/generated/dpnp.scipy.linalg.lu_solve.html#dpnp.scipy.linalg.lu_solve">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">lu_solve</span><span class="p">(</span><span class="n">lu_and_piv</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">trans</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">overwrite_b</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">check_finite</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Solve a linear system, :math:`a x = b`, given the LU factorization of `a`.</span>

<span class="sd">    For full documentation refer to :obj:`scipy.linalg.lu_solve`.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    lu, piv : {tuple of dpnp.ndarrays or usm_ndarrays}</span>
<span class="sd">        LU factorization of matrix `a` (..., M, M) together with pivot indices.</span>
<span class="sd">    b : {(M,), (..., M, K)} {dpnp.ndarray, usm_ndarray}</span>
<span class="sd">        Right-hand side</span>
<span class="sd">    trans : {0, 1, 2} , optional</span>
<span class="sd">        Type of system to solve:</span>

<span class="sd">        =====  =================</span>
<span class="sd">        trans  system</span>
<span class="sd">        =====  =================</span>
<span class="sd">        0      :math:`a x = b`</span>
<span class="sd">        1      :math:`a^T x = b`</span>
<span class="sd">        2      :math:`a^H x = b`</span>
<span class="sd">        =====  =================</span>

<span class="sd">        Default: ``0``.</span>
<span class="sd">    overwrite_b : {None, bool}, optional</span>
<span class="sd">        Whether to overwrite data in `b` (may increase performance).</span>

<span class="sd">        Default: ``False``.</span>
<span class="sd">    check_finite : {None, bool}, optional</span>
<span class="sd">        Whether to check that the input matrix contains only finite numbers.</span>
<span class="sd">        Disabling may give a performance gain, but may result in problems</span>
<span class="sd">        (crashes, non-termination) if the inputs do contain infinities or NaNs.</span>

<span class="sd">        Default: ``True``.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    x : {(M,), (..., M, K)} dpnp.ndarray</span>
<span class="sd">        Solution to the system</span>

<span class="sd">    Warning</span>
<span class="sd">    -------</span>
<span class="sd">    This function synchronizes in order to validate array elements</span>
<span class="sd">    when ``check_finite=True``.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    :obj:`dpnp.scipy.linalg.lu_factor` : LU factorize a matrix.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; import dpnp as np</span>
<span class="sd">    &gt;&gt;&gt; A = np.array([[2, 5, 8, 7], [5, 2, 2, 8], [7, 5, 6, 6], [5, 4, 4, 8]])</span>
<span class="sd">    &gt;&gt;&gt; b = np.array([1, 1, 1, 1])</span>
<span class="sd">    &gt;&gt;&gt; lu, piv = np.scipy.linalg.lu_factor(A)</span>
<span class="sd">    &gt;&gt;&gt; x = np.scipy.linalg.lu_solve((lu, piv), b)</span>
<span class="sd">    &gt;&gt;&gt; np.allclose(A @ x - b, np.zeros((4,)))</span>
<span class="sd">    array(True)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="p">(</span><span class="n">lu</span><span class="p">,</span> <span class="n">piv</span><span class="p">)</span> <span class="o">=</span> <span class="n">lu_and_piv</span>
    <span class="n">dpnp</span><span class="o">.</span><span class="n">check_supported_arrays_type</span><span class="p">(</span><span class="n">lu</span><span class="p">,</span> <span class="n">piv</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
    <span class="n">assert_stacked_2d</span><span class="p">(</span><span class="n">lu</span><span class="p">)</span>
    <span class="n">assert_stacked_square</span><span class="p">(</span><span class="n">lu</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dpnp_lu_solve</span><span class="p">(</span>
        <span class="n">lu</span><span class="p">,</span>
        <span class="n">piv</span><span class="p">,</span>
        <span class="n">b</span><span class="p">,</span>
        <span class="n">trans</span><span class="o">=</span><span class="n">trans</span><span class="p">,</span>
        <span class="n">overwrite_b</span><span class="o">=</span><span class="n">overwrite_b</span><span class="p">,</span>
        <span class="n">check_finite</span><span class="o">=</span><span class="n">check_finite</span><span class="p">,</span>
    <span class="p">)</span></div>

</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020-2025, Intel Corporation.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>